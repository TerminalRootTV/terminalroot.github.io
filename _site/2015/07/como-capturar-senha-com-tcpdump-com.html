<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<title>Como capturar a senha com TCPDump</title>
	<meta content="width=device-width, initial-scale=1.0" name="viewport">
	<meta name="keywords" content="linux, shell script, bash, desenvolvimento, tecnologia">
	<meta name="description" content="">
	<meta name="author" content="Marcos Oliveira">
	<meta name="robots" content="noodp">
	<meta name="reply-to" content="contato@terminalroot.com.br">
	<meta name="generator" content="VIM - Vi IMproved 8.1 (2018 May 18, compiled Apr  7 2019 00:42:18)">
	<meta name="google-site-verification" content="zMxWGsmS5xlxc71KSaJx77T6CfB4bP3hdO_v5qfAsuY">
	<meta name="p:domain_verify" content="2fedc285bd24f0b5808c51a4cbd58e86"/>
	<!-- Favicons -->
	<link href="/assets/img/site/favicon.png" rel="icon">
	<link href="/assets/img/site/apple-touch-icon.png" rel="apple-touch-icon">
	
	<!-- Google Analytics -->
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-75725905-1', 'auto');
	  ga('send', 'pageview');

	</script>

	<!-- Social: Twitter -->
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:site" content="@terminalroottv">
	<meta name="twitter:title" content="Como capturar a senha com TCPDump">
	<meta name="twitter:description" content="Isso serve como conhecimento de proteção, ou seja, alguém que está usando sua rede WI-FI por exemplo">
	
	<meta property="twitter:image:src" content="http://localhost:4000/assets/img/hacker/tcpdump.jpg">
	

	<!-- Social: Facebook / Open Graph -->
	<meta property="og:url" content="http://localhost:4000/2015/07/como-capturar-senha-com-tcpdump-com.html">
	<meta property="og:title" content="Como capturar a senha com TCPDump">
	
	<meta property="og:image" content="http://localhost:4000/assets/img/hacker/tcpdump.jpg">
	
	<meta property="og:description" content="Isso serve como conhecimento de proteção, ou seja, alguém que está usando sua rede WI-FI por exemplo">
	<meta property="og:site_name" content="Terminal Root">
	<meta property="fb:admins" content="439112053506193"/>


	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i|Montserrat:300,400,500,700" rel="stylesheet">
	<!-- Bootstrap CSS File -->
	<link href="/assets/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<!-- Libraries CSS Files -->
	<link href="/assets/lib/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/lib/animate/animate.min.css" rel="stylesheet">
	<link href="/assets/lib/ionicons/css/ionicons.min.css" rel="stylesheet">
	<link href="/assets/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
	<link href="/assets/lib/lightbox/css/lightbox.min.css" rel="stylesheet">
	<!-- My Main Stylesheet File -->
	<link rel="stylesheet" href="/assets/css/main.css">
	<link rel="canonical" href="http://localhost:4000/2015/07/como-capturar-senha-com-tcpdump-com.html">
	<link rel="alternate" type="application/rss+xml" title="Terminal Root" href="http://localhost:4000/feed.xml">
	<!-- Main Stylesheet File -->
	<link rel="stylesheet" href="/assets/css/style.css">
</head>

<body>

<header id="header" class="fixed-top">
 <div class="container">
    <div class="logo float-left">
       <!-- Uncomment below if you prefer to use an image logo -->
       <!-- <h1 class="text-light"><a href="#header"><span>NewBiz</span></a></h1> -->
       <a href="/" class="scrollto"><img src="/assets/img/site/logo-blog.png" alt="Terminal Root Logomarca" class="img-fluid"></a>
    </div>
    <nav class="main-nav float-right d-none d-lg-block">
       <ul>
          <li class="active"><a href="/"><i class="fa fa-home"></i> Home</a></li>
          <li><a href="/promo"><i class="fa fa-user"></i> Promoção</a></li>
          <li><a href="/cursos"><i class="fa fa-graduation-cap"></i> Cursos</a></li>
          <li><a href="/blog"><i class="fa fa-comment"></i> Blog</a></li>
          <li>                  
			<a href="#footer" data-toggle="popover" title="Contate-nos:" data-placement="bottom" data-content="contato@terminalroot.com.br">
				<i class="fa fa-paper-plane"></i> Contato
			</a>					
          </li>
          <li>
			<a data-toggle="modal" data-target="#mySearch" class="mySearch" style="cursor:pointer;color:#fff;">
				<i class="fa fa-search" aria-hidden="true"></i> Busca
			</a>
          </li>
       </ul>
    </nav>
    <!-- .main-nav -->
 </div>
</header>


<section id="post-page-header" class="clearfix">


  <div class="page-post-header-info text-center">
    <h2>Como capturar a senha com TCPDump</h2>
    <h4>Isso serve como conhecimento de proteção, ou seja, alguém que está usando sua rede WI-FI por exemplo</h4>
	<p style="color: #babdb6;">
		<time datetime="2015-07-18T19:37:00-03:00" itemprop="datePublished">Jul 18, 2015</time>
	</p>
  </div>
</section><!-- #page-post-header -->
  
  <main id="main">
  <section id="post-page">
 
  	<p><img src="/assets/img/hacker/tcpdump.jpg" alt="TCPDump Hacker Blog Linux" /></p>

<p>Se você não possui o TCPDump, use o gerenciador de pacotes correspondente da sua distro para instalá-lo, ou <a href="http://www.tcpdump.org/">baixe aqui</a> e compile-o.</p>

<p>Instalação num máquina com <a href="http://terminalroot.com.br/tags#linux">GNU/Linux</a> <a href="http://terminalroot.com.br/tags#debian">Debian</a>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">su
apt-get <span class="nb">install </span>tcpdump</code></pre></figure>

<p>Aqui eu fiz um teste utilizando a seguinte estrutura:</p>

<p><img src="/assets/img/hacker/capturando.gif" alt="Blog Linux" title="Capturando TCPDump" /></p>

<p>O <strong>Notebook</strong> que possui o endereço <strong>192.168.1.3</strong> acessará o <strong>PC 192.168.1.2</strong> que possui o formulário, o mesmo formulário criado nesse post. A “ponte”(<strong>Gateway</strong>) para essa comunicação é um <strong>Modem/Roteador 192.168.1.1</strong> , mesmo sem internet, ele iria permitir essa comunicação (lógico :P).</p>

<p>No PC vou setar o comando do TCPDump para capturar o pacote e salvar os dados num arquivo que eu chamei de <strong>pegandoasenha-tcpdump.txt</strong> (já deixei até o arquivo aberto, e só cliquei em recarregar para mostrar os dados do arquivo modificado). Então já rodei o comando e o TCPDump ficou aguardando os pacotes que o Notebook(192.168.1.3) estava enviando para o PC(192.168.1.2).</p>

<p>Se o PC fosse o Gateway, também dava pra pegar os dados que estava sendo enviado, pois estaria passando pelo PC, ou seja, pra você pegar os dados que estão passado pelo seu Roteador, você precisa configurá-lo com o TCPDump, blz?! O proxy também faz isso, mas isso aqui é só um teste pra saber a utulização do TCPDump! :)</p>

<p>No PC o comando utilizado pra isso foi:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"> tcpdump <span class="nt">-nAs0</span> <span class="nt">-i</span> eth0 <span class="s1">'port 80'</span> <span class="o">&gt;&gt;</span> pegandoasenha-tcpdump.txt </code></pre></figure>

<ul>
  <li>-n Não converter endereços (ou seja, endereços de hosts, números de portas, etc.) para nomes.</li>
  <li>-A Imprimir cada pacote (menos seu cabeçalho ) em ASCII. Para a captura de páginas da web.</li>
  <li>-s Ver todos os dados da captura</li>
  <li>-i Interface de rede, no meu caso é a eth0’port 80’</li>
  <li>HTTPpegandoasenha-tcpdump.txt Arquivo que eu quero salvar os dados, mas se eu não utilizasse redirecionador(») , ele mostraria na tela!</li>
</ul>

<p>Após eu dar enter nesse comando, o TCPDump capturará todas as requisições que passem pelo meu IP. Então fui lá no Notebook e enviei os dados para o formulário. Utilizei:</p>

<blockquote>
  <p>Nome de usuário: pegar a senha</p>
</blockquote>

<blockquote>
  <p>Senha: facil ok</p>
</blockquote>

<p>Depois fui ver o arquivo e estava lá a senha.</p>

<p>O arquivo possui vários dados (Navegador, IP, hora, data,…) ex.:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">17:40:37.142723 IP 192.168.1.3.55480 <span class="o">&gt;</span> 192.168.1.2.80: Flags <span class="o">[</span>S], <span class="nb">seq </span>881644111, win 29200, options <span class="o">[</span>mss 1460,sackOK,TS val 662693 ecr 0,nop,wscale 7], length 0
E..&lt;..@.@..<span class="o">{</span>...........P4..O......r.V..........
<span class="nb">.</span>
..........
17:40:37.142778 IP 192.168.1.2.80 <span class="o">&gt;</span> 192.168.1.3.55480: Flags <span class="o">[</span>S.], <span class="nb">seq </span>3895379345, ack 881644112, win 28960, options <span class="o">[</span>mss 1460,sackOK,TS val 1618431 ecr 662693,nop,wscale 7], length 0
E..&lt;..@.@..f.........P......4..P..q ...........
.....
......
17:40:37.167604 IP 192.168.1.3.55480 <span class="o">&gt;</span> 192.168.1.2.80: Flags <span class="o">[</span>.], ack 1, win 229, options <span class="o">[</span>nop,nop,TS val 662694 ecr 1618431], length 0
E..4..@.@..............P4..P...............
<span class="nb">.</span>
......
17:40:37.167833 IP 192.168.1.3.55480 <span class="o">&gt;</span> 192.168.1.2.80: Flags <span class="o">[</span>P.], <span class="nb">seq </span>1:499, ack 1, win 229, options <span class="o">[</span>nop,nop,TS val 662694 ecr 1618431], length 498
E..&amp;..@.@..............P4..P...............
<span class="nb">.</span>
......POST /formulario.php HTTP/1.1
Host: 192.168.1.2
User-Agent: Mozilla/5.0 <span class="o">(</span>X11<span class="p">;</span> Linux i686<span class="p">;</span> rv:31.0<span class="o">)</span> Gecko/20100101 Firefox/31.0 Iceweasel/31.7.0
Accept: text/html,application/xhtml+xml,application/xml<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.9,<span class="k">*</span>/<span class="k">*</span><span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.8
Accept-Language: pt-BR,pt<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.8,en-US<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.5,en<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.3
Accept-Encoding: <span class="nb">gzip</span>, deflate
Referer: http://192.168.1.2/formulario.php
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 53

<span class="nv">nome</span><span class="o">=</span>pegar+a+senha&amp;senha<span class="o">=</span>facil+ok&amp;enviar<span class="o">=</span>Enviar+dados
17:40:37.167879 IP 192.168.1.2.80 <span class="o">&gt;</span> 192.168.1.3.55480: Flags <span class="o">[</span>.], ack 499, win 235, options <span class="o">[</span>nop,nop,TS val 1618437 ecr 662694], length 0
E..4w.@.@.?..........P......4..B...........
.....
..
17:40:37.170762 IP 192.168.1.2.80 <span class="o">&gt;</span> 192.168.1.3.55480: Flags <span class="o">[</span>P.], <span class="nb">seq </span>1:230, ack 499, win 235, options <span class="o">[</span>nop,nop,TS val 1618438 ecr 662694], length 229
E...w.@.@.&gt;..........P......4..B...........
.....
..HTTP/1.1 200 OK
Date: Sat, 18 Jul 2015 20:40:37 GMT
Server: Apache/2.4.10 <span class="o">(</span>Debian<span class="o">)</span>
Content-Length: 25
Keep-Alive: <span class="nb">timeout</span><span class="o">=</span>5, <span class="nv">max</span><span class="o">=</span>100
Connection: Keep-Alive
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8

Dados salvos com sucesso!
17:40:37.171716 IP 192.168.1.3.55480 <span class="o">&gt;</span> 192.168.1.2.80: Flags <span class="o">[</span>.], ack 230, win 237, options <span class="o">[</span>nop,nop,TS val 662701 ecr 1618438], length 0
E..4..@.@..............P4..B...w.....&amp;.....
<span class="nb">.</span>
......
17:40:42.173212 IP 192.168.1.3.55480 <span class="o">&gt;</span> 192.168.1.2.80: Flags <span class="o">[</span>F.], <span class="nb">seq </span>499, ack 230, win 237, options <span class="o">[</span>nop,nop,TS val 663951 ecr 1618438], length 0
E..4..@.@..............P4..B...w.....C.....
<span class="nb">.</span>
<span class="o">!</span>.....
17:40:42.173326 IP 192.168.1.2.80 <span class="o">&gt;</span> 192.168.1.3.55480: Flags <span class="o">[</span>F.], <span class="nb">seq </span>230, ack 500, win 235, options <span class="o">[</span>nop,nop,TS val 1619689 ecr 663951], length 0
E..4w.@.@.?..........P.....w4..C.....a.....
.....
<span class="o">!</span><span class="nb">.</span>
17:40:42.174337 IP 192.168.1.3.55480 <span class="o">&gt;</span> 192.168.1.2.80: Flags <span class="o">[</span>.], ack 231, win 237, options <span class="o">[</span>nop,nop,TS val 663951 ecr 1619689], length 0
E..4..@.@..~...........P4..C...x....._.....
<span class="nb">.</span>
<span class="o">!</span>.....</code></pre></figure>

<p>A linha correspondente que mostra os dados que possui a senha é:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">nome</span><span class="o">=</span>pegar+a+senha&amp;senha<span class="o">=</span>facil+ok&amp;enviar<span class="o">=</span>Enviar+dados</code></pre></figure>

<p>Você pode aumentar sua produtividade utilizando mais informações, existe várias opções para o TCPDump:</p>

<p>Exemplo de comando tcpdump para mostrar quais as ligações de um determinado endereço tcp-ip à porta 80 do seu servidor:</p>

<blockquote>
  <p>tcpdump -ni eth0 src “numero ip” and dst port 80</p>
</blockquote>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">tcpdump <span class="nt">-i</span> eth0</code></pre></figure>

<p>Conexões de origem podem ser monitoradas utilizando o parâmetro src host, um exemplo simples seria monitorarmos o tráfego que vem de 192.168.1.9 para nosso computador, com o ip 192.168.1.2. A linha de comando ficaria da seguinte forma:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">tcpdump <span class="nt">-i</span> eth0 src host 192.168.1.9</code></pre></figure>

<p>Se quisermos monitorar as conexões especificando um host de destino, poderíamos fazê-lo com o parâmetro dst host, o exemplo abaixo mostra todo o tráfego do host 192.168.1.2 com 192.168.1.1, no caso, 192.168.1.1 é nosso gateway.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">tcpdump <span class="nt">-i</span> eth0 dst host 192.168.1.1</code></pre></figure>

<p>Mais:</p>

<p>http://www.tcpdump.org/</p>

<p>https://pt.wikipedia.org/wiki/Tcpdump</p>

<p>http://www.imartins.com.br/informix/artigos/capturando-senha-usuarios</p>


  </section>
  </main>
  
  <section id="marketing" class="section-bg" style="color: #fff;">
  <div class="container text-center">
    <p class="ph1">Curso Intensivo de Shell Script Avançado</p>
    <p>Aprenda tudo sobre Terminfo e Termcap, manipulação de Sistema de Arquivos via linha de comando, criação de games, manuais, processos, animações em ASCII e Unicode.</p>
    <a href="/shell">
    	<button class="btn btn-saiba-mais">Mais detalhes</button>
    </a>
  </div>
</section><!-- #marketing -->


</div>



<footer id="footer">
 <div class="footer-top">
    <div class="container">
       <div class="row">
          <div class="col-lg-4 col-md-6 footer-info">
             <p><img src="/assets/img/site/logo-blog.png" alt="" class="img-fluid"></p>
             <br>
             <p>Site sobre GNU/Linux, Desenvolvimento de software, Gentoo, BSD, Open Source e Software Livre . Compra segura e conteúdo confiável via PagSeguro e PayPal .</p>
             <br>
             <img src="/assets/img/site/paycards.png" alt="Bandeiras de cartões" title="Via PagSeguro e PayPal" class="img-footer">
          </div>
          <div class="col-lg-2 col-md-6 footer-links">
             <h4>Links úteis</h4>
             <ul>
                <li><a href="#intro">Home</a></li>
                <li><a href="#about">Como funciona</a></li>
                <li><a href="#services">Cursos</a></li>
                <li><a href="#why-us">Blog</a></li>
             </ul>
          </div>
          <div class="col-lg-3 col-md-6 footer-contact">
             <h4>Contato</h4>
             <p>
                Londrina, Paraná<br>
                Brasil <br>
                <strong>Email:</strong> contato@terminalroot.com.br<br>
             </p>
             <div class="social-links">
                <a href="https://youtube.com/TerminalRootTV" class="youtube"><i class="fa fa-youtube"></i></a>
                <a href="https://twitter.com/TerminalRootTV" class="twitter"><i class="fa fa-twitter"></i></a>
                <a href="https://facebook.com/TerminalRootTV" class="facebook"><i class="fa fa-facebook"></i></a>
                <a href="https://rss.com/TerminalRootTV" class="rss"><i class="fa fa-rss"></i></a>                            
             </div>
          </div>
          <div class="col-lg-3 col-md-6 footer-newsletter">
             <h4>Nosso Newsletter</h4>
             <p>Receba nossas novidades por e-mail.</p>
             <div id="form">
                <input type="email" name="email" id="email"><input type="submit" class="register" value="Inscreva-me">
             </div>
          </div>
       </div>
    </div>
 </div>
 <div class="container">
    <div class="copyright">
       &copy; Copyright <strong>Terminal Root</strong>. Todos os Direitos Reservados
    </div>
    <!--
       <div class="credits">        
         By <a href="https://bootstrapmade.com/">BootstrapMade</a> e modificado por <a href="https://www.linkedin.com/in/marcos-oliveira-049327166/">Marcos Oliveira</a>
       </div>
       -->
 </div>
</footer>

<!-- #footer -->
<a href="#" class="back-to-top"><i class="fa fa-chevron-up"></i></a>
<!-- Uncomment below i you want to use a preloader -->
<!-- <div id="preloader"></div> -->
<!-- JavaScript Libraries -->
<script src="/assets/lib/jquery/jquery.min.js"></script>
<script src="/assets/lib/jquery/jquery-migrate.min.js"></script>
<script src="/assets/lib/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="/assets/lib/easing/easing.min.js"></script>
<script src="/assets/lib/mobile-nav/mobile-nav.js"></script>
<script src="/assets/lib/wow/wow.min.js"></script>
<script src="/assets/lib/waypoints/waypoints.min.js"></script>
<script src="/assets/lib/counterup/counterup.min.js"></script>
<script src="/assets/lib/owlcarousel/owl.carousel.min.js"></script>
<script src="/assets/lib/isotope/isotope.pkgd.min.js"></script>
<script src="/assets/lib/lightbox/js/lightbox.min.js"></script>
<script src="/assets/js/main.js"></script>
<script src="/assets/js/sweetalert.min.js"></script>
<script>
$(document).ready(function(){
	$('[data-toggle="popover"]').popover();
	$(".close").click(function(){
		//alert("Clicou");
		//$("#mySearch").hide();
		location.reload();
	});
	$(".register").click(function(){
		var mail = $("#email").val();
		if ( mail != "" ){
			var msg = "Olá, " + mail + "!\n";
		}else{
			var msg = "";
		}
		swal(msg + "Esse campo ainda está em desenvolvimento.\nObrigado por tentar se inscrever.");
	});
});
</script>
  <div class="modal fade text-center" id="mySearch" role="dialog">

    
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal">&times;</button>
    </div>
    
    <input type="text" id="search-input" value="Digite o que você procura aqui" onblur="if(this.value == ''){ this.value='Digite o que você procura aqui';}" onfocus="if(this.value == 'Digite o que você procura aqui'){ this.value='';}">
    <br>
    <ul id="results-container"></ul>
      
    </div>
    
  <script src="/assets/js/search-script.min.js" type="text/javascript"></script>
  <script>
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('results-container'),
    json: '/search.json',
  })
  </script>



</body>
</html>
